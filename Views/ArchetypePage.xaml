<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:CharactersOfCthulhu.Models"
             xmlns:viewmodels="clr-namespace:CharactersOfCthulhu.ViewModels"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:DataType="viewmodels:ArchetypePageViewModel"
             x:Class="CharactersOfCthulhu.Views.ArchetypePage"
             Title="Select Archetype">

    <Grid RowDefinitions="*,Auto">

        <ScrollView Grid.Row="0">
            <VerticalStackLayout Padding="10" Spacing="5">

                <Label Text="Select Pulp Archetype" 
                       FontSize="22" 
                       FontAttributes="Bold"
                       Padding="10,0" />

                <CollectionView ItemsSource="{Binding Archetypes}"
                                SelectionMode="Single"
                                SelectedItem="{Binding SelectedArchetype, Mode=TwoWay}">
                    <CollectionView.ItemTemplate>
                        <DataTemplate x:DataType="viewmodels:ArchetypeViewModel">
                            <Frame Margin="10,5" Padding="0" CornerRadius="5">
                                <Frame.Triggers>
                                    <DataTrigger TargetType="Frame"
                                                 Binding="{Binding IsExpanded}"
                                                 Value="True">
                                        <Setter Property="BorderColor" Value="{StaticResource Primary}" />
                                        <Setter Property="Background" Value="#22FFFFFF" />
                                    </DataTrigger>
                                    <DataTrigger TargetType="Frame"
                                                 Binding="{Binding IsExpanded}"
                                                 Value="False">
                                        <Setter Property="BorderColor" Value="Gray" />
                                        <Setter Property="Background" Value="Transparent" />
                                    </DataTrigger>
                                </Frame.Triggers>

                                <toolkit:Expander IsExpanded="{Binding IsExpanded, Mode=TwoWay}">
                                    <toolkit:Expander.Header>
                                        <Label Text="{Binding Name}"
                                               FontSize="18"
                                               FontAttributes="Bold"
                                               Margin="10" />
                                    </toolkit:Expander.Header>
                                    <toolkit:Expander.Content>
                                        <Label Text="{Binding Description}"
                                               FontSize="14"
                                               Margin="10,0,10,10" />
                                    </toolkit:Expander.Content>
                                </toolkit:Expander>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>

                <VerticalStackLayout Spacing="5" 
                                     Padding="10"
                                     IsVisible="{Binding ShowCoreCharacteristicChoice}">
                    <Label Text="Select Core Characteristic" FontAttributes="Bold" />
                    <Label Text="This archetype allows a choice for the core stat." FontSize="12" />
                    <Picker ItemsSource="{Binding CoreCharacteristicChoices}"
                            SelectedItem="{Binding SelectedCoreCharacteristic}"
                            Title="Select Stat" />
                </VerticalStackLayout>

            </VerticalStackLayout>
        </ScrollView>

        <Grid Grid.Row="1" ColumnDefinitions="*,*" Padding="10">
            <Button Grid.Column="0"
                    Text="Back"
                    Command="{Binding GoBackCommand}"
                    HorizontalOptions="Start" />
            <Button Grid.Column="1"
                    Text="Next"
                    Command="{Binding GoToNextPageCommand}"
                    HorizontalOptions="End" />
        </Grid>
    </Grid>
</ContentPage>